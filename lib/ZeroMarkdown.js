export default class a{constructor(t=""){this.currentIndex=0,this.metadata={},this.lines=a.preprocess(t),this.tokens=this.tokenize()}static preprocess(t,e=`
`){return t.trim().split(e).map(s=>s.trim()===""?" ":s)}currentLine(t=!0){const e=this.lines[this.currentIndex];return t&&e?e.trim():e}nextLine(t=!0){this.currentIndex++;const e=this.lines[this.currentIndex];return t&&e?e.trim():e}peekLine(t=!0){const e=this.lines[this.currentIndex+1];return t&&e?e.trim():e}tokenize(){const t=[];for(;this.currentIndex<this.lines.length;){const e=this.parseLine(this.currentLine());e&&t.push(e),this.currentIndex++}return t.push(this.createToken("END","END")),t}createToken(t,e,s={}){return{type:t,content:this.parseContent(e),props:s}}parseContent(t){let e=0,s="";for(;e<t.length;){const i=t[e];let l=!1,o=e;const n=r=>t[e]!==r?(s+=t.substring(o,e+1),l=!0,!0):!1;e:if(i==="["){let r="",h="";for(;t[e+1]!=="]"&&t[e+1];)e++,r+=t[e];if(e+=2,n("("))break e;for(;t[e+1]!==")"&&t[e+1];)e++,h+=t[e];e++,s+=`<a href="${h}">${r}</a>`,l=!0}e:if(i==="!"&&!l){let r="",h="";if(e++,n("["))break e;for(;t[e+1]!=="]";)e++,r+=t[e];if(e+=2,n("("))break e;for(;t[e+1]!==")";)e++,h+=t[e];e++,s+=`<img src="${h}" alt="${r}" />`,l=!0}e:if(i==="_"&&!l){let r="";for(;t[e+1]!=="_"&&t[e+1];)e++,r+=t[e];if(e++,n("_"))break e;s+=`<i>${r}</i>`,l=!0}e:if(i==="`"&&!l){let r="";for(;t[e+1]!=="`"&&t[e+1];)e++,r+=t[e];if(e++,n("`"))break e;s+=`<code data-type="inline">${r}</code>`,l=!0}e:if(i==="*"&&!l){let r="";if(e++,n("*"))break e;for(;t[e+1]!=="*"&&t[e+1];)e++,r+=t[e];if(e++,n("*")||(e++,n("*")))break e;s+=`<b>${r}</b>`,l=!0}l||(s+=i),e++}return s}parseLine(t){if(t==="---"){for(;this.peekLine()!=="---"&&this.peekLine();){const[e,...s]=this.nextLine().split(":");this.metadata[e.trim()]=s.join(" ").trim()}return this.nextLine(),null}else if(t.startsWith("```")){let e=[],s=t.substring(3).trim();for(;this.peekLine()!=="```"&&this.peekLine(!1);)e.push(this.nextLine(!1));this.nextLine();const i=e.join(`
`).replace(/</g,"&lt;").replace(/>/g,"&gt;");return s.length>0?this.createToken("code",i,{"data-type":s}):this.createToken("code",i)}else if(t.startsWith("#")){const e=t.split(" ").shift(),s=e.length;return e.split("").filter(i=>i==="#").length==s?this.createToken(`h${s}`,t.substring(s).trimStart()):this.createToken("p",t)}else{if(t.startsWith(">"))return this.createToken("blockquote",t.substring(1).trimStart());if(t.startsWith("- "))return this.createToken("ul",t.substring(1).trimStart());if(Number.isInteger(parseInt(t.split(".").shift()))){const e=t.split(".").shift();return this.createToken("ol",t.substring(e.length+1).trimStart())}}return this.createToken("p",t)}createElement(t,e,s={}){let i=[];for(const[o,n]of Object.entries(s))i.push(`${o}="${n}"`);return`<${`${t} ${i.join(" ")}`.trim()}>${e}</${t}>`}render(){let t="",e=0;e:for(;e<this.tokens.length;){const s=this.tokens[e];if(s.type==="END"&&s.content==="END")break e;if(s.type==="ul"){for(t+="<ul>";this.tokens[e].type==="ul";)t+=this.createElement("li",this.tokens[e].content,this.tokens[e].props),e++;e--,t+="</ul>"}else if(s.type==="ol"){for(t+="<ol>";this.tokens[e].type==="ol";)t+=this.createElement("li",this.tokens[e].content,this.tokens[e].props),e++;e--,t+="</ol>"}else if(s.type==="blockquote"){const i=[];for(;this.tokens[e].type==="blockquote";)i.push(this.tokens[e].content),e++;e--,t+=`<blockquote>${i.join("<br />")}</blockquote>`}else s.type==="code"?t+=`<pre>${this.createElement(s.type,s.content,this.tokens[e].props)}</pre>`:t+=this.createElement(s.type,s.content,this.tokens[e].props);e++}return t}}
