export default class a{constructor(t=""){this.currentIndex=0,this.metadata={},this.lines=a.preprocess(t),this.tokens=this.tokenize()}static preprocess(t,e=`
`){return t.split(e).map(s=>s.trim()).filter(s=>s.length)}get currentLine(){return this.lines[this.currentIndex]}nextLine(){return this.currentIndex++,this.lines[this.currentIndex]}peekLine(){return this.lines[this.currentIndex+1]}tokenize(){const t=[];for(;this.currentIndex<this.lines.length;){const e=this.parseLine(this.currentLine);e&&t.push(e),this.currentIndex++}return t.push(this.createToken("END","END")),t}createToken(t,e,s={}){return{type:t,content:this.parseContent(e),props:s}}parseContent(t){let e=0,s="";for(;e<t.length;){const r=t[e];let n=!1,o=e;const l=i=>t[e]!==i?(s+=t.substring(o,e+1),n=!0,!0):!1;e:if(r==="["){let i="",h="";for(;t[e+1]!=="]"&&t[e+1];)e++,i+=t[e];if(e+=2,l("("))break e;for(;t[e+1]!==")"&&t[e+1];)e++,h+=t[e];e++,s+=`<a href="${h}">${i}</a>`,n=!0}e:if(r==="!"&&!n){let i="",h="";if(e++,l("["))break e;for(;t[e+1]!=="]";)e++,i+=t[e];if(e+=2,l("("))break e;for(;t[e+1]!==")";)e++,h+=t[e];e++,s+=`<img src="${h}" alt="${i}" />`,n=!0}e:if(r==="_"&&!n){let i="";for(;t[e+1]!=="_"&&t[e+1];)e++,i+=t[e];if(e++,l("_"))break e;s+=`<i>${i}</i>`,n=!0}e:if(r==="`"&&!n){let i="";for(;t[e+1]!=="`"&&t[e+1];)e++,i+=t[e];if(e++,l("`"))break e;s+=`<code data-type="inline">${i}</code>`,n=!0}e:if(r==="*"&&!n){let i="";if(e++,l("*"))break e;for(;t[e+1]!=="*"&&t[e+1];)e++,i+=t[e];if(e++,l("*")||(e++,l("*")))break e;s+=`<b>${i}</b>`,n=!0}n||(s+=r),e++}return s}parseLine(t){if(t==="---"){for(;this.peekLine()!=="---"&&this.peekLine();){const[e,...s]=this.nextLine().split(":");this.metadata[e.trim()]=s.join(" ").trim()}return this.nextLine(),null}else if(t.startsWith("```")){let e=[],s=t.substring(3);for(;this.peekLine()!=="```"&&this.peekLine();)e.push(this.nextLine());return this.nextLine(),s?this.createToken("code",e.join(`
`),{"data-type":s}):this.createToken("code",e.join(`
`))}else if(t.startsWith("#")){const e=t.split(" ").shift(),s=e.length;return e.split("").filter(r=>r==="#").length==s?this.createToken(`h${s}`,t.substring(s).trimStart()):this.createToken("p",t)}else{if(t.startsWith(">"))return this.createToken("blockquote",t.substring(1).trimStart());if(t.startsWith("- "))return this.createToken("ul",t.substring(1).trimStart());if(Number.isInteger(parseInt(t.split(".").shift()))){const e=t.split(".").shift();return this.createToken("ol",t.substring(e.length+1).trimStart())}}return this.createToken("p",t)}createElement(t,e,s={}){let r=[];for(const[o,l]of Object.entries(s))r.push(`${o}="${l}"`);return`<${`${t} ${r.join(" ")}`.trim()}>${e}</${t}>`}render(){let t="",e=0;e:for(;e<this.tokens.length;){const s=this.tokens[e];if(s.type==="END"&&s.content==="END")break e;if(s.type==="ul"){for(t+="<ul>";this.tokens[e].type==="ul";)t+=this.createElement("li",this.tokens[e].content,this.tokens[e].props),e++;e--,t+="</ul>"}else if(s.type==="ol"){for(t+="<ol>";this.tokens[e].type==="ol";)t+=this.createElement("li",this.tokens[e].content,this.tokens[e].props),e++;e--,t+="</ol>"}else if(s.type==="blockquote"){const r=[];for(;this.tokens[e].type==="blockquote";)r.push(this.tokens[e].content),e++;e--,t+=`<blockquote>${r.join("<br />")}</blockquote>`}else s.type==="code"?t+=`<pre>${this.createElement(s.type,s.content,this.tokens[e].props)}</pre>`:t+=this.createElement(s.type,s.content,this.tokens[e].props);e++}return t}}